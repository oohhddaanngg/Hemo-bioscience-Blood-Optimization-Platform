Blood Optimization Platform ‚Äî Project Current Work
üìå Current Version
Version: v0.3.9 (In Development)
Release date: 2025-??-??

üöß Active Work in Progress
Enhance Future Specs optimization algorithm
    - Objective: Transform the Future Specs module into a recommendation engine.
    - Logic: Create a new function `runFutureSpecOptimization()` to scan for and suggest potential ways to fulfill future orders using existing inventory or planned standing orders.
    - UI Impact: The Future Specs panel will be updated to display these optimization suggestions.

üß™ Testing Focus
Validate Future Specs optimization algorithm suggestions.
    - Confirm compatibility checks are accurate.
    - Verify fulfillment window calculations are correct.
Confirm allocation ledger prevents double-booking.
Verify decision logging captures all critical events.

‚úÖ Recent Completions
Future Specs display initialization bug fixed.
Antigen/antibody format migration for legacy data completed.
Data persistence for Quantities CSV.
Blank specification handling (blank = "ANY type acceptable").
Data persistence for Quantities CSV.
Blank specification handling (blank = "ANY type acceptable").
BUP output now shows ranges (min/max overage).
Standing order cell details (HQC-1, HQC-2, HQC-3, etc.) included in allocations.
PT-to-PT event sharing implemented.
Allocation ledger system introduced.
Multi-unit cohort consistency enforced.
Decision logging + Activity Log integration.
Year-aware BUP generation (customer/event/year now tracked).

üîú Next Planned Work
üîú Next Planned Work

**Phase 1: Forecasting & Data Infrastructure**
-   **Build Historical Quantities Module:**
    -   Develop the UI and backend logic for the "Historical Quantities" modal to allow for the input and storage of past order data.
-   **Create Forecasting Module:**
    -   Implement a "Forecasted Order Quantities" modal that uses data from both historical and current year orders to project future needs (e.g., for 2026).
-   **Integrate Forecasting with Future Specs:**
    -   Connect the "Future Specifications" module to the new forecasting module, so it can automatically use projected quantities for planning.

**Phase 2: Supplier & Cost Management**
-   **Build Blood Suppliers Module:**
    -   Repurpose the "Vendors" placeholder.
    -   Create a modal that allows for entering detailed, customizable pricing structures for each blood supplier (e.g., cost per antigen, rarity surcharges, blood type costs).
    -   Integrate this data to calculate and display potential order costs from various suppliers.
-   **Build Antibody Suppliers Module:**
    -   Create a new modal to manage antibody suppliers, including their product offerings, price per ml, and bulk discount rules.

**Phase 3: UI/UX & Cleanup**
-   **Rename Modals for Clarity:**
    -   Rename "Order Quantities" to "Current Year Order Quantities".
    -   Rename "Specifications" to "Confirmed Specifications".
    -   Rename "Vendors" to "Blood Suppliers".
-   **Remove Redundant Modals:**
    -   Remove the "Specifications Generator" placeholder, as its functionality is handled by the "Future Specifications" module.

üß≠ Notes for Developers
Refer to Project Instructions for dev rules and workflow.
Refer to Project Quick Reference for business logic cheat sheet.
Refer to Project Reference Briefing for full technical + business context.
Do not edit those documents here ‚Äî this file is the only one to update regularly.

üóÇ Version Changelog
v0.3.9 ‚Äî 2025-??-?? (In Development)
Highlights:
    - Began development of the Future Specs optimization algorithm.
Details:
    - Fixed: Future Specs panel now displays correctly after a page refresh, even with no entries.
    - Added: A robust data migration function to automatically convert legacy antigen/antibody and DAT status formats to the new standard upon data load.
    - Testing:
        - ‚úÖ Future Specs display persistence verified.
        - ‚úÖ Legacy data migration for customerSpecs, futureSpecs, and historical versions confirmed.
---

v0.3.8 ‚Äî 2025-??-??
Highlights:
    - Implemented allocation ledger system.
    - Added PT-to-PT sharing capability.
Introduced decision logging with Activity/Decisions tabs.
Enforced multi-unit cohort consistency.
Added year-aware BUP generation.

Details:
Fixed: Quantities CSV persistence.
Fixed: Blank specification handling (ABO/Rh/antigens = ANY when blank).
Changed: BUP output now shows ranges (min/max overage).
Added: Standing-order cell details (HQC-1, HQC-2, HQC-3).
Added: Allocation ledger with global tracking.
Added: Decision logging + audit trail.

Testing:
‚úÖ OneWorld 4th 2025 pulls from HQC-2 & HQC-3.
‚úÖ ISLA 3rd 2025 shares with HQC, Korea, OneWorld 3rd, Aurevia 2nd, API 3rd.
‚úÖ Blank ABO and Rh specs accept any blood type.
‚úÖ PT events share with each other (not themselves).
‚úÖ Allocation ledger prevents double-use.
‚úÖ Decision logging functional.

v0.3.7 ‚Äî 2025-??-??
Highlights:
Applied HQC date-finding fix to Korea, C3, and MQC standing orders.
Removed global ‚Äúfirst match‚Äù calendar searches ‚Äî ensured matches remain window-specific.

Details:
Fixed: Calendar logic now only searches within event windows.
Fixed: Date matching logic corrected for Korea, C3, MQC events.
Improved: Event search functions more reliable across schedules.

Testing:
‚úÖ Verified HQC/Korea/C3 events pull blood within allowed windows.
‚úÖ No global bleed-date assumptions remain.

v0.3.6 ‚Äî 2025-??-??
Highlights:
First critical bug-fix release addressing core platform stability.

Details:
Fixed: Quantities CSV now persists after refresh.
Fixed: Blank specifications now treated as ANY ABO/Rh/antigens.
Changed: BUP output now shows ranges (min ‚Üí max overage).
Added: Allocations specify exact standing-order cell (HQC-1, HQC-2, etc.).

Testing:
‚úÖ CSV persistence verified across refreshes.
‚úÖ Blank ABO/Rh/antigen fields tested ‚Üí accept all valid blood.
‚úÖ BUP output validated with min/max ranges.
‚úÖ Standing-order allocations labeled correctly.

v0.3.5 ‚Äî 2025-??-?? (Baseline)
Highlights:
First functional version of the Blood Optimization Platform.
Contained critical bugs requiring immediate fix in later versions.

Details:
Issue: Quantities CSV did not persist after refresh.
Issue: Blank ABO/Rh specs not handled as ‚ÄúANY acceptable.‚Äù
Issue: BUP output showed single values, not ranges.
Issue: Did not specify which standing-order cell was used.
Missing: PT-to-PT sharing ‚Äî only standing orders were checked.

Testing:
‚ùå Data persistence failed on refresh.
‚ùå Blank ABO/Rh caused rejections instead of ANY.
‚ùå BUP outputs inaccurate (single values only).

‚ùå No PT-to-PT sharing tested.
